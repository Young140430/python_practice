import torch

h = torch.Tensor([1,3,5,7,9])
y = torch.Tensor([1,3,2,7,5])
print(torch.sum(torch.eq(h,y).float())/h.shape[0])
print(torch.mean(torch.eq(h,y).float()))

# h = torch.Tensor([[0.0830, 0.0886, 0.1130, 0.0913, 0.1086, 0.0863, 0.1086, 0.1086, 0.1057,
#          0.1062],
#         [0.0829, 0.0897, 0.1092, 0.0949, 0.1070, 0.0868, 0.1064, 0.1091, 0.1059,
#          0.1081],
#         [0.0842, 0.0905, 0.1105, 0.0936, 0.1088, 0.0890, 0.1048, 0.1071, 0.1051,
#          0.1064],
#         [0.0852, 0.0894, 0.1109, 0.0927, 0.1099, 0.0867, 0.1080, 0.1073, 0.1063,
#          0.1036],
#         [0.0870, 0.0902, 0.1097, 0.0929, 0.1068, 0.0898, 0.1043, 0.1070, 0.1044,
#          0.1078]])
# y = torch.Tensor([[1., 0., 0., 0., 0., 0., 0., 0., 0., 0.],
#         [0., 0., 0., 0., 1., 0., 0., 0., 0., 0.],
#         [0., 0., 0., 0., 0., 0., 0., 1., 0., 0.],
#         [0., 1., 0., 0., 0., 0., 0., 0., 0., 0.],
#         [0., 0., 0., 0., 0., 0., 0., 1., 0., 0.]])
#
# #将one_hot编码转回输原始标签
# h = torch.argmax(h,dim=1)
# y = torch.argmax(y,dim=1)
# print(h)
# print(y)
#
# print(torch.sum(torch.eq(h,y).float())/h.shape[0])
